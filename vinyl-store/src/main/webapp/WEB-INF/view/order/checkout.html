<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}"/>
    <link rel="stylesheet" th:href="@{/webjars/font-awesome/5.15.1/css/all.min.css}"/>
    <link rel="stylesheet" th:href="@{/css/main.css}"/>

    <title>Checkout</title>
</head>
<body>

<div th:replace="fragments/header :: #header"></div>

<br>

<div class="container">
    <div class="text-center">
        <h2>Checkout</h2>
    </div>

    <div class="alert alert-danger" role="alert" th:text="${error}" th:if="${error}"></div>

    <div class="row">
        <div class="col-md-4 order-md-2 mb-4">
            <h4 class="d-flex justify-content-between align-items-center mb-3">
                <span class="text-muted">Your cart</span>
                <span class="badge badge-secondary badge-pill" th:text="${session.cart.items.size()}">N</span>
            </h4>
            <ul class="list-group mb-3">
                <li class="list-group-item d-flex justify-content-between lh-condensed"
                    th:each="item : ${session.cart.items}">
                    <div class="mr-5">
                        <h6 class="my-0" th:text="${item.product.name}">Product name</h6>
                        <!--                            <small class="text-muted">Brief description</small>-->
                    </div>
                    <span class="text-muted" style="float: right; width: 70px"
                          th:text="${item.product.price} + '&times;' + ${item.quantity}">Price</span>
                </li>
                <li class="list-group-item d-flex justify-content-between">
                    <span>Total</span>
                    <strong th:text="${session.cart.total}">Total price</strong>
                </li>
            </ul>
        </div>
        <div class="col-md-8 order-md-1">
            <h4 class="mb-3">Address</h4>
            <form class="needs-validation" novalidate th:object="${checkoutForm}" th:action="@{/checkout/place-order}"
                  method="post">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="firstName">First name*</label>
                        <input type="text" class="form-control" id="firstName" placeholder="First name"
                               required th:field="*{firstName}">
                        <p class="error" th:if="${#fields.hasErrors('firstName')}" th:errors="*{firstName}">First Name
                            Error</p>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="lastName">Last name*</label>
                        <input type="text" class="form-control" id="lastName" placeholder="Last name"
                               required th:field="*{lastName}">
                        <p class="error" th:if="${#fields.hasErrors('lastName')}" th:errors="*{lastName}">Last Name
                            Error</p>
                    </div>
                </div>

                <div class="mb-3">
                    <label for="phoneNumber">Phone number*</label>
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text">+</span>
                        </div>
                        <input type="tel" class="form-control" id="phoneNumber" maxlength="11"
                               placeholder="1111-111-11-11" pattern="[0-9]{4}-[0-9]{3}-[0-9]{2}-[0-9]{2}"
                               th:field="*{phoneNumber}" required>
                    </div>
                    <p class="error" th:if="${#fields.hasErrors('phoneNumber')}" th:errors="*{phoneNumber}">Phone Number
                        Error</p>
                </div>

                <div class="row">
                    <div class="col-md-5 mb-3">
                        <label for="street">Street*</label>
                        <input type="text" class="form-control" id="street" placeholder="Main St"
                               required th:field="*{address.street}">
                        <p class="error" th:if="${#fields.hasErrors('address.street')}" th:errors="*{address.street}">
                            Street Error</p>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label for="building">Building*</label>
                        <input type="text" class="form-control" id="building" placeholder="1234"
                               th:field="*{address.building}" required>
                        <p class="error" th:if="${#fields.hasErrors('address.building')}"
                           th:errors="*{address.building}">Building Error</p>
                    </div>
                    <div class="col-md-3 mb-3">
                        <label for="apartment">Apartment</label>
                        <input type="text" class="form-control" id="apartment" placeholder="1"
                               th:field="*{address.apartment}">
                        <p class="error" th:if="${#fields.hasErrors('address.apartment')}"
                           th:errors="*{address.apartment}">Apartment Error</p>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-5 mb-3">
                        <label for="country">Country*</label>
                        <select class="custom-select d-block w-100" id="country" required
                                th:field="*{address.countryId}">
                            <option value="-1">Choose country</option>
                            <option th:each="country : ${countries}"
                                    th:value="${country.id}" th:text="${country.name}">Country name
                            </option>
                        </select>
                        <p class="error" th:if="${#fields.hasErrors('address.countryId')}"
                           th:errors="*{address.countryId}">Country Error</p>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label for="town">Town*</label>
                        <select class="custom-select d-block w-100" id="town" th:field="*{address.townId}" required>
                            <option value="-1">Choose town</option>
                        </select>
                        <p class="error" th:if="${#fields.hasErrors('address.townId')}" th:errors="*{address.townId}">
                            Town Error</p>
                    </div>
                    <div class="col-md-3 mb-3">
                        <label for="zip">Postal code*</label>
                        <input type="text" class="form-control" id="zip" placeholder="94115" required
                               th:field="*{address.postalCode}">
                        <p class="error" th:if="${#fields.hasErrors('address.postalCode')}"
                           th:errors="*{address.postalCode}">Postal Code Error</p>
                    </div>
                </div>

                <!--                    <div class="custom-control custom-checkbox">-->
                <!--                        <input type="checkbox" class="custom-control-input" id="save-info">-->
                <!--                        <label class="custom-control-label" for="save-info">Save this information for next time</label>-->
                <!--                    </div>-->
                <hr class="mb-3">

                <h4 class="mb-3">Delivery options</h4>

                <div class="d-block my-3 form-group">
                    <div class="custom-control custom-radio" th:each="option : ${deliveryOptions}">
                        <input type="radio" th:field="*{deliveryMethodId}" class="custom-control-input"
                               th:id="'delivery' + ${option.id}"
                               th:value="${option.id}" required>
                        <label th:for="'delivery' + ${option.id}" th:text="${option.companyName}"
                               class="custom-control-label">Delivery
                            method</label>
                    </div>
                    <p class="error" th:if="${#fields.hasErrors('deliveryMethodId')}" th:errors="*{deliveryMethodId}">
                        Building Error</p>
                </div>

                <hr class="mb-3">

                <h4 class="mb-3">Payment</h4>

                <div class="d-block my-3 form-group">
                    <div class="custom-control custom-radio" th:each="option : ${paymentOptions}"
                         th:field="*{paymentMethod}">
                        <input th:id="${option}" th:field="*{paymentMethod}" type="radio" th:value="${option}"
                               class="custom-control-input"
                               th:checked="${option == option.CREDIT_CARD}" required>
                        <label class="custom-control-label" th:for="${option}" th:text="${option.getMethodName()}">Payment
                            method</label>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="cc-number">Credit card number</label>
                        <input type="text" class="form-control" id="cc-number" placeholder="Credit card number">
                        <div class="invalid-feedback">
                            Credit card number is required
                        </div>
                    </div>
                    <!--                    </div>-->
                    <!--                    <div class="row">-->
                    <div class="col-md-3 mb-3">
                        <label for="cc-expiration">Expiration</label>
                        <input type="text" class="form-control" id="cc-expiration" placeholder="00/00">
                        <div class="invalid-feedback">
                            Expiration date required
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <label for="cc-cvv">CVV</label>
                        <input type="text" class="form-control" id="cc-cvv" placeholder="000">
                        <div class="invalid-feedback">
                            Security code required
                        </div>
                    </div>
                </div>
                <hr class="mb-4">
                <button class="btn btn-dark btn-lg btn-block" type="submit">Continue to checkout</button>
            </form>
        </div>
    </div>


</div>

<div th:replace="fragments/footer :: #footer"></div>


<script th:src="@{/js/jquery-3.5.1.min.js}"></script>
<script th:src="@{/js/bootstrap.min.js}"></script>
<script th:src="@{/js/main.js}"></script>
<script th:src="@{/js/order/checkout.js}"></script>

</body>
</html>